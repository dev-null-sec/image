/*
 * ===================================================================
 *  Giscus 美化主题 - “晴川无痕” V17 (最终形态)
 *  为 dev-null-sec 量身打造的最终决战方案
 * ===================================================================
 */

/* --- 【核心配置区】 --- */
:root {
  --giscus-main-bg: rgba(255, 255, 255, 0.85) !important;
  --giscus-main-radius: 20px !important;
  --giscus-button-bg: #007BFF !important;
  --giscus-button-bg-hover: #0056b3 !important;
  --giscus-button-color: #ffffff !important;
  --giscus-text-color: #2c3e50 !important;
  --giscus-text-color-secondary: #5a6a7a !important;
  --giscus-input-bg: rgba(255, 255, 255, 0.95) !important;
  --giscus-input-border-color: rgba(200, 200, 200, 0.6) !important;
  --giscus-separator-color: rgba(0, 0, 0, 0.12) !important; 
  --giscus-bg-image-url: url('https://cdn.jsdelivr.net/gh/dev-null-sec/image@main/img/20250824173829149.webp') !important;
}

/* --- 整体容器与精准切除 (保持不变) --- */
main { padding: 0 !important; border: none !important; }
.gsc-main { padding: 25px !important; background-color: var(--giscus-main-bg) !important; border-radius: var(--giscus-main-radius) !important; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08) !important; }
.gsc-comment > .color-bg-primary, .gsc-comment-box, .gsc-comment-box-textarea-extras, .gsc-reactions, .gsc-header, .gsc-comment-footer, .gsc-reply-box { border: none !important; background: none !important; box-shadow: none !important; }

/* --- 核心重建 (保持不变) --- */
.gsc-comment-box-textarea { background-color: var(--giscus-input-bg) !important; border: 1px solid var(--giscus-input-border-color) !important; border-radius: 15px !important; color: var(--giscus-text-color) !important; background-image: var(--giscus-bg-image-url) !important; background-position: 100% 100% !important; background-repeat: no-repeat !important; background-size: 100px !important; padding: 15px 120px 15px 15px !important; transition: all 0.3s ease !important; resize: vertical !important; }
.gsc-comment-box-textarea:focus { border-color: var(--giscus-button-bg) !important; box-shadow: 0 0 10px rgba(0, 123, 255, 0.25) !important; }
.gsc-comment { padding: 20px 0 !important; border-bottom: 1px dashed var(--giscus-separator-color) !important; }
.gsc-timeline > .gsc-comment:last-of-type { border-bottom: none !important; padding-bottom: 0 !important; }
.gsc-reply-box { margin-top: 15px !important; text-align: right !important; }
.gsc-reply-box > button { background: none !important; border: none !important; width: auto !important; padding: 5px !important; font-size: 0 !important; cursor: pointer !important; border-radius: 50% !important; transition: background-color 0.2s ease; }
.gsc-reply-box > button:hover { background-color: rgba(0, 0, 0, 0.05) !important; }
.gsc-reply-box > button::before { content: ''; display: inline-block; width: 16px; height: 16px; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%235a6a7a'%3E%3Cpath d='M1 2.75C1 1.784 1.784 1 2.75 1h10.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 13.25 12H9.06l-2.573 2.573A1.458 1.458 0 0 1 4 13.442V12H2.75A1.75 1.75 0 0 1 1 10.25Z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: center; }
.gsc-comment-box-buttons .btn-primary { background-color: var(--giscus-button-bg) !important; background-image: none !important; color: var(--giscus-button-color) !important; border: none !important; border-radius: 12px !important; font-weight: 600 !important; padding: 10px 20px !important; }
.gsc-comment-box-buttons .btn-primary:hover { background-color: var(--giscus-button-bg-hover) !important; transform: translateY(-2px) !important; }
.gsc-comment-box-bottom { display: flex !important; justify-content: space-between !important; align-items: center !important; margin-top: 10px !important; }
.gsc-comment-box-bottom > button[type="button"] { background: none !important; color: var(--giscus-text-color-secondary) !important; }
.gsc-comment-box-tabs, .gsc-comment-box-md-toolbar, .gsc-comment-box-markdown-hint { display: none !important; }

/* --- 【最终形态核心】将“管理”链接，变成不那么显眼的“...”按钮 --- */

.gsc-comment-header { position: relative !important; }
a[href*="discussioncomment"] {
  /* 把它变成一个又小又方的透明按钮 */
  position: absolute !important; top: 10px; right: 10px;
  width: 28px !important; height: 28px !important;
  background-color: transparent !important; /* 默认透明 */
  border-radius: 50% !important; /* 圆形按钮 */
  transition: background-color 0.2s ease !important;
  
  /* 把里面的文字（比如时间戳）彻底隐藏掉 */
  font-size: 0 !important;
  color: transparent !important;
  text-decoration: none !important;
}
/* 隐藏里面的 time 标签，双重保险 */
a[href*="discussioncomment"] > time { display: none !important; }

/* 使用伪元素，画出三个点！ */
a[href*="discussioncomment"]::before {
  content: '···';
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%); /* 完美居中 */
  
  font-size: 16px !important;
  font-weight: bold !important;
  color: #aaa !important; /* 默认是低调的灰色 */
  letter-spacing: 1px;
  line-height: 1; /* 确保垂直居中 */
  
  transition: color 0.2s ease !important;
}

/* 鼠标悬浮时，按钮出现淡淡的背景，三个点变蓝 */
a[href*="discussioncomment"]:hover {
  background-color: rgba(0, 123, 255, 0.1) !important;
}
a[href*="discussioncomment"]:hover::before {
  color: var(--giscus-button-bg) !important;
}

.giscus-container {
  position: relative;
  min-height: 300px; /* 给骨架屏一个最小高度 */
}

/* Giscus iframe 默认先透明，等待加载完成后再淡入 */
.giscus-frame {
  opacity: 0;
  transition: opacity 0.5s ease !important;
}

.giscus-skeleton {
  width: 100%;
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1;
  transition: opacity 0.5s ease;
  padding: 25px;
  background-color: rgba(255, 255, 255, 0.85);
  border-radius: 20px;
}

.skeleton-item {
  background-color: #e0e6ec;
  border-radius: 8px;
  animation: shimmer 1.5s infinite linear;
}

.skeleton-input {
  height: 100px;
  margin-bottom: 20px;
}

.skeleton-comment {
  display: flex;
  align-items: flex-start;
  margin-bottom: 20px;
  background: none; /* 评论容器本身是透明的 */
  animation: none;
}
.skeleton-comment:last-child {
  margin-bottom: 0;
}

.skeleton-avatar {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  margin-right: 15px;
  flex-shrink: 0;
}

.skeleton-lines {
  flex-grow: 1;
  background: none; /* 行容器本身是透明的 */
  animation: none;
}

.skeleton-line {
  height: 12px;
  margin-bottom: 8px;
  border-radius: 4px;
}
.skeleton-line:last-child {
  margin-bottom: 0;
}

/* 当 Giscus 加载完成后，骨架屏淡出 */
.giscus-skeleton.is-loaded {
  opacity: 0;
  pointer-events: none; /* 让它不再阻挡鼠标事件 */
}

/* 闪烁动画 */
@keyframes shimmer {
  0% { background-color: #e0e6ec; }
  50% { background-color: #f0f3f6; }
  100% { background-color: #e0e6ec; }
}