/*
 * ===================================================================
 *  Giscus 美化主题 - “晴川无痕” V14 (权限最终版)
 *  为 dev-null-sec 量身打造的最终决战方案
 * ===================================================================
 */

/* --- 【核心配置区】 --- */
:root {
  --giscus-main-bg: rgba(255, 255, 255, 0.85) !important;
  --giscus-main-radius: 20px !important;
  --giscus-button-bg: #007BFF !important;
  --giscus-button-bg-hover: #0056b3 !important;
  --giscus-button-color: #ffffff !important;
  --giscus-text-color: #2c3e50 !important;
  --giscus-text-color-secondary: #5a6a7a !important;
  --giscus-input-bg: rgba(255, 255, 255, 0.95) !important;
  --giscus-input-border-color: rgba(200, 200, 200, 0.6) !important;
  /* 【修改点】分割线颜色加深一点，更明显 */
  --giscus-separator-color: rgba(0, 0, 0, 0.15) !important;
  --giscus-bg-image-url: url('https://cdn.jsdelivr.net/gh/dev-null-sec/image@main/img/2025824173829149.webp') !important;
}

/* --- 整体容器样式 --- */
main { padding: 0 !important; border: none !important; }
.gsc-main {
  padding: 25px !important; background-color: var(--giscus-main-bg) !important;
  border-radius: var(--giscus-main-radius) !important; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08) !important;
}

/* --- 精准切除所有不想要的边框和背景 --- */
.gsc-comment > .color-bg-primary,
.gsc-comment-box,
.gsc-comment-box-textarea-extras,
.gsc-reactions,
.gsc-header,
.gsc-comment-footer,
.gsc-replies { /* 【修改点】回复区的外框也干掉 */
  border: none !important; background: none !important; box-shadow: none !important;
}

/* --- 核心重建 --- */

/* 重建：评论输入框 */
.gsc-comment-box-textarea {
  background-color: var(--giscus-input-bg) !important; border: 1px solid var(--giscus-input-border-color) !important;
  border-radius: 15px !important; color: var(--giscus-text-color) !important;
  background-image: var(--giscus-bg-image-url) !important; background-position: 100% 100% !important;
  background-repeat: no-repeat !important; background-size: 100px !important;
  padding: 15px 120px 15px 15px !important; transition: all 0.3s ease !important; resize: vertical !important;
}
.gsc-comment-box-textarea:focus { border-color: var(--giscus-button-bg) !important; box-shadow: 0 0 10px rgba(0, 123, 255, 0.25) !important; }

/* 【修改点】重建：所有分割线，统一为更粗、更明显的灰色虚线 */
.gsc-comment,
.gsc-replies { /* 主评论和回复区的下方，都用这种分割线 */
  padding-top: 20px !important;
  border-bottom: 2px dashed var(--giscus-separator-color) !important;
}
.gsc-timeline > .gsc-comment:last-of-type {
  border-bottom: none !important;
}
/* 回复区内部的分割线 */
.gsc-reply {
  padding: 15px 0 !important;
  border-top: 1px dashed var(--giscus-separator-color) !important;
}
.gsc-replies > .gsc-reply:first-of-type {
  border-top: none !important;
  padding-top: 0 !important;
}
.gsc-comment-content { background: none !important; border: none !important; }
/* Giscus 自带的回复树状线，我们也美化一下 */
.gsc-tl-line {
  background-color: var(--giscus-separator-color) !important;
}


/* 重建：“回复”按钮 */
.gsc-reply-box {
  margin-top: 15px !important; text-align: right !important; border-top: none !important;
}
.gsc-reply-box > button {
  background: none !important; border: none !important; width: auto !important; padding: 5px !important;
  font-size: 0 !important; cursor: pointer !important; border-radius: 50% !important; transition: background-color 0.2s ease;
}
.gsc-reply-box > button:hover { background-color: rgba(0, 0, 0, 0.05) !important; }
.gsc-reply-box > button::before {
  content: ''; display: inline-block; width: 16px; height: 16px;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%235a6a7a'%3E%3Cpath d='M1 2.75C1 1.784 1.784 1 2.75 1h10.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 13.25 12H9.06l-2.573 2.573A1.458 1.458 0 0 1 4 13.442V12H2.75A1.75 1.75 0 0 1 1 10.25Z'/%3E%3C/svg%3E");
  background-repeat: no-repeat; background-position: center;
}

/* 重建：蓝色评论按钮 */
.gsc-comment-box-buttons .btn-primary {
  background-color: var(--giscus-button-bg) !important; background-image: none !important;
  color: var(--giscus-button-color) !important; border: none !important;
  border-radius: 12px !important; font-weight: 600 !important; padding: 10px 20px !important;
}
.gsc-comment-box-buttons .btn-primary:hover {
  background-color: var(--giscus-button-bg-hover) !important; transform: translateY(-2px) !important;
}

/* --- 清理与功能保留 --- */
.gsc-comment-box-bottom { display: flex !important; justify-content: space-between !important; align-items: center !important; margin-top: 10px !important; }
.gsc-comment-box-bottom > button[type="button"] { background: none !important; color: var(--giscus-text-color-secondary) !important; }
.gsc-comment-box-tabs, .gsc-comment-box-md-toolbar, .gsc-comment-box-markdown-hint { display: none !important; }


/* --- 【最终修正】“在 GitHub 上管理”按钮的权限控制 --- */
.gsc-comment-header { position: relative !important; }
/* 默认情况下，所有管理按钮都隐藏 */
a[href*="discussioncomment"] {
  display: none !important;
}
/* 只有当用户是“所有者”时，才显示管理按钮 */
.gsc-comment-author-is-owner a[href*="discussioncomment"] {
  display: inline-block !important; /* 或者 flex, block 等，只要不是 none */
  position: absolute !important; top: 15px; right: 15px;
  background-color: rgba(0, 123, 255, 0.1) !important;
  color: var(--giscus-button-bg) !important;
  padding: 4px 10px !important;
  border-radius: 20px !important;
  font-size: 12px !important;
}
a[href*="discussioncomment"] > time { display: none !important; }
a[href*="discussioncomment"]::after { content: '管理'; }
a[href*="discussioncomment"]:hover { background-color: rgba(0, 123, 255, 0.2) !important; }